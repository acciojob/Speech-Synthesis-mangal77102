<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Speech Synthesis App</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 40px auto;
    }
    textarea {
      width: 100%;
      height: 120px;
      margin-bottom: 10px;
    }
    select, input, button {
      margin: 8px 0;
      width: 100%;
      padding: 6px;
    }
    label {
      font-weight: bold;
    }
  </style>
</head>
<body>

  <h2>Text to Speech App</h2>

  <textarea id="text" placeholder="Enter text here..."></textarea>

  <label>Select Voice</label>
  <select id="voiceSelect"></select>

  <label>Rate</label>
  <input type="range" id="rate" min="0.5" max="2" step="0.1" value="1">

  <label>Pitch</label>
  <input type="range" id="pitch" min="0.5" max="2" step="0.1" value="1">

  <button id="speak">Speak</button>
  <button id="stop">Stop</button>

<script>
  const textArea = document.getElementById("text");
  const voiceSelect = document.getElementById("voiceSelect");
  const speakBtn = document.getElementById("speak");
  const stopBtn = document.getElementById("stop");
  const rateSlider = document.getElementById("rate");
  const pitchSlider = document.getElementById("pitch");

  let voices = [];

  // Load voices properly
  function populateVoices() {
    voices = window.speechSynthesis.getVoices();

    voiceSelect.innerHTML = "";

    if (voices.length === 0) {
      const option = document.createElement("option");
      option.textContent = "No voices available";
      voiceSelect.appendChild(option);
      speakBtn.disabled = true;
      return;
    }

    voices.forEach((voice, index) => {
      const option = document.createElement("option");
      option.value = index;
      option.textContent = `${voice.name} (${voice.lang})`;
      voiceSelect.appendChild(option);
    });

    // Select first voice by default
    voiceSelect.selectedIndex = 0;
  }

  // Some browsers load voices asynchronously
  if (speechSynthesis.onvoiceschanged !== undefined) {
    speechSynthesis.onvoiceschanged = populateVoices;
  }

  populateVoices();

  function speakText() {
    const text = textArea.value.trim();

    if (!text) {
      alert("Please enter some text!");
      return;
    }

    // Stop previous speech
    speechSynthesis.cancel();

    const utterance = new SpeechSynthesisUtterance(text);

    const selectedVoice = voices[voiceSelect.value];
    if (selectedVoice) {
      utterance.voice = selectedVoice;
    }

    utterance.rate = parseFloat(rateSlider.value);
    utterance.pitch = parseFloat(pitchSlider.value);

    speechSynthesis.speak(utterance);
  }

  function stopSpeech() {
    speechSynthesis.cancel();
  }

  // Restart if voice changes while speaking
  voiceSelect.addEventListener("change", () => {
    if (speechSynthesis.speaking) {
      speakText();
    }
  });

  // Restart if rate changes
  rateSlider.addEventListener("input", () => {
    if (speechSynthesis.speaking) {
      speakText();
    }
  });

  // Restart if pitch changes
  pitchSlider.addEventListener("input", () => {
    if (speechSynthesis.speaking) {
      speakText();
    }
  });

  speakBtn.addEventListener("click", speakText);
  stopBtn.addEventListener("click", stopSpeech);
</script>

  </script>

</body>
</html>
